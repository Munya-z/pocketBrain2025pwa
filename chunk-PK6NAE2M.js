import{a as w}from"./chunk-CG3X2B2L.js";import{a as F,b as q,c as N,d as T,e as V,f as m,g as A,h as z,j as D,k as G,l as j,m as B,n as $,o as L,p as R}from"./chunk-Z4UVNOQN.js";import{a as W}from"./chunk-Y6PIL4JR.js";import{e as E}from"./chunk-5OJ3AFNZ.js";import"./chunk-KHYJEK4E.js";import{Aa as x,Pa as f,Qa as S,Ra as g,Sa as n,Ta as i,Ua as v,Va as M,Wa as p,Xa as O,Y as C,Z as k,_ as y,ab as o,bb as u,cb as P,db as I,eb as b,fa as h,sa as l,wa as d}from"./chunk-RB5HBADI.js";var J=(a,t)=>t.id;function X(a,t){if(a&1&&(n(0,"option",6),o(1),i()),a&2){let e=t.$implicit;g("value",b(e.item)),l(),u(e.item)}}function H(a,t){if(a&1){let e=M();n(0,"div",12)(1,"div",23)(2,"p",24),o(3),i(),n(4,"p",25),o(5),i()(),n(6,"div",26)(7,"p",13),o(8),i(),y(),n(9,"svg",27),p("click",function(){let c=C(e).$implicit,s=O();return k(s.deletecartItem(c.id))}),v(10,"path",28),i()()()}if(a&2){let e=t.$implicit;l(3),u(e.item),l(2),I(" ",e.quantity," X ",e.price),l(3),u(e.quantity*e.price)}}function K(a,t){a&1&&(n(0,"p",13),o(1,"cart is empty"),i())}var _=class a{constructor(t,e,r){this.stockService=t;this.fundsService=e;this.route=r}cartItems=h([]);addToCart(){let t={id:"",item:"",quantity:0,price:0};t.item=this.saleForm.value.product??"",t.quantity=this.saleForm.value.quantity??0,t.id=this.findStockIdByName(t.item),t.price=this.findStockPriceById(t.id),this.cartItems.update(e=>[...e,t]),this.saleForm.get("product")?.reset(),this.saleForm.get("quantity")?.reset()}deletecartItem(t){this.cartItems.update(e=>e.filter(r=>r.id!==t))}sellItem(){if(this.saleForm.valid&&this.cartItems().length>0){let t={id:"",date:new Date,amount:this.calculateTotalCost(),paymentMethod:this.saleForm.value.paymentMethod??"",itemsSold:this.cartItems()};for(let e of this.cartItems()){let r=this.stockService.getStock().filter(c=>c.id===e.id);r[0]&&(r[0].quantity-=e.quantity,this.stockService.getStock.update(c=>c.map(s=>s.id===r[0].id?r[0]:s)),localStorage.setItem("stock",JSON.stringify(this.stockService.getStock())))}this.fundsService.createSalesEntry(t),this.saleForm.reset(),this.cartItems.set([]),this.route.navigate(["/"])}}calculateTotalCost(){let t=0;return this.cartItems().forEach(e=>{t+=e.price*e.quantity}),t}findStockIdByName(t){return this.stockService.getStock().find(r=>r.item===t).id}findStockPriceById(t){return this.stockService.getStock().find(r=>r.id===t).price}saleForm=new V({id:new m(""),product:new m(""),date:new m(""),quantity:new m(0),paymentMethod:new m("",q.required)});static \u0275fac=function(e){return new(e||a)(d(W),d(w),d(E))};static \u0275cmp=x({type:a,selectors:[["app-sell-stock"]],decls:44,vars:3,consts:[[1,"form-container"],[1,"xxl-font","mb-1"],[3,"formGroup"],[1,"container"],["for","product",1,"clr-m"],["name","product","formControlName","product","id","product"],[3,"value"],["for","quantity",1,"clr-m"],["type","number","formControlName","quantity","name","quantity","id","quantity"],[1,"cart-btn","edit","mb-2",3,"click"],[1,"xl-font","mb-1"],[1,"cart"],[1,"cart-item"],[1,"medium-font"],["for","payment",1,"clr-m"],["name","payment","id","payment","formControlName","paymentMethod"],["value","cash"],["value","card"],["value","credit"],["value","giveAway"],["value","other"],[1,"total-bill","xxl-font","m-hz"],[1,"submit-btn","main",3,"click"],[1,"name"],[1,"medium-font","clr-m","mb-1"],[1,"small-font"],[1,"full-price"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 448 512",1,"delete-cart-item",3,"click"],["d","M135.2 17.7C140.6 6.8 151.7 0 163.8 0L284.2 0c12.1 0 23.2 6.8 28.6 17.7L320 32l96 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 96C14.3 96 0 81.7 0 64S14.3 32 32 32l96 0 7.2-14.3zM32 128l384 0 0 320c0 35.3-28.7 64-64 64L96 512c-35.3 0-64-28.7-64-64l0-320zm96 64c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16z"]],template:function(e,r){e&1&&(n(0,"section",0)(1,"h2",1),o(2,"New Sale"),i(),n(3,"form",2)(4,"div",3)(5,"label",4),o(6,"select product"),i(),n(7,"select",5),f(8,X,2,3,"option",6,J),i()(),n(10,"div",3)(11,"label",7),o(12,"quantity"),i(),v(13,"input",8),i(),n(14,"button",9),p("click",function(){return r.addToCart()}),o(15,"add to cart"),i(),n(16,"div",3)(17,"p",10),o(18,"cart items"),i(),n(19,"div",11),f(20,H,11,4,"div",12,J,!1,K,2,0,"p",13),i()(),n(23,"div",3)(24,"label",14),o(25,"payment method"),i(),n(26,"select",15)(27,"option",16),o(28,"cash"),i(),n(29,"option",17),o(30,"EFT"),i(),n(31,"option",18),o(32,"credit"),i(),n(33,"option",19),o(34,"give away"),i(),n(35,"option",20),o(36,"other"),i()()(),n(37,"div",21)(38,"p"),o(39,"total"),i(),n(40,"p"),o(41),i()(),n(42,"button",22),p("click",function(){return r.sellItem()}),o(43,"add sale"),i()()()),e&2&&(l(3),g("formGroup",r.saleForm),l(5),S(r.stockService.getStock()),l(12),S(r.cartItems()),l(21),P("$\xA0",r.calculateTotalCost()))},dependencies:[R,A,B,$,F,z,j,N,T,D,G,L],styles:[".quick-info[_ngcontent-%COMP%]{max-width:600px;display:flex;justify-content:space-between;align-items:center;padding:10px;margin:1rem auto;padding-inline:5vw}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .cart[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-bottom:1rem}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .cart[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]{display:flex}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .cart[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .full-price[_ngcontent-%COMP%]{margin-left:auto;display:flex;align-items:center;gap:1rem}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .cart[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .full-price[_ngcontent-%COMP%]   .delete-cart-item[_ngcontent-%COMP%]{margin-left:auto;cursor:pointer;width:1.2rem;height:1.2rem;fill:red;transition:all .3s ease-in-out}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .total-bill[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}"]})};export{_ as default};
