import{a as P}from"./chunk-CG3X2B2L.js";import{a as b,b as E,c as I,d as F,e as w,f as c,g as q,h as N,j as T,k as A,l as z,m as D,n as G,o as V,p as j}from"./chunk-Z4UVNOQN.js";import{a as B}from"./chunk-Y6PIL4JR.js";import{e as O}from"./chunk-5OJ3AFNZ.js";import"./chunk-KHYJEK4E.js";import{Aa as k,Pa as p,Qa as u,Ra as f,Sa as n,Ta as i,Ua as S,Wa as g,_,ab as o,bb as d,cb as h,db as x,eb as M,fa as y,sa as l,wa as s}from"./chunk-RB5HBADI.js";var L=(a,t)=>t.id;function R(a,t){if(a&1&&(n(0,"option",6),o(1),i()),a&2){let e=t.$implicit;f("value",M(e.item)),l(),d(e.item)}}function $(a,t){if(a&1&&(n(0,"div",12)(1,"div",23)(2,"p",24),o(3),i(),n(4,"p",25),o(5),i()(),n(6,"div",26)(7,"p",13),o(8),i(),_(),n(9,"svg",27),S(10,"path",28),i()()()),a&2){let e=t.$implicit;l(3),d(e.item),l(2),x(" ",e.quantity," X ",e.price),l(3),d(e.quantity*e.price)}}function W(a,t){a&1&&(n(0,"p",13),o(1,"cart is empty"),i())}var v=class a{constructor(t,e,r){this.stockService=t;this.fundsService=e;this.route=r}cartItems=y([]);addToCart(){let t={id:"",item:"",quantity:0,price:0};t.item=this.saleForm.value.product??"",t.quantity=this.saleForm.value.quantity??0,t.id=this.findStockIdByName(t.item),t.price=this.findStockPriceById(t.id),this.cartItems.update(e=>[...e,t]),console.log(this.cartItems(),"cart items"),this.saleForm.get("product")?.reset(),this.saleForm.get("quantity")?.reset()}sellItem(){if(this.saleForm.valid&&this.cartItems().length>0){let t={id:"",date:new Date,amount:this.calculateTotalCost(),paymentMethod:this.saleForm.value.paymentMethod??"",itemsSold:this.cartItems()};for(let e of this.cartItems()){let r=this.stockService.getStock().filter(m=>m.id===e.id);r[0]&&(r[0].quantity-=e.quantity,this.stockService.getStock.update(m=>m.map(C=>C.id===r[0].id?r[0]:C)),localStorage.setItem("stock",JSON.stringify(this.stockService.getStock())))}this.fundsService.createSalesEntry(t),this.saleForm.reset(),this.cartItems.set([]),this.route.navigate(["/"])}}calculateTotalCost(){let t=0;return this.cartItems().forEach(e=>{t+=e.price*e.quantity}),t}findStockIdByName(t){return this.stockService.getStock().find(r=>r.item===t).id}findStockPriceById(t){return this.stockService.getStock().find(r=>r.id===t).price}saleForm=new w({id:new c(""),product:new c(""),date:new c(""),quantity:new c(0),paymentMethod:new c("",E.required)});static \u0275fac=function(e){return new(e||a)(s(B),s(P),s(O))};static \u0275cmp=k({type:a,selectors:[["app-sell-stock"]],decls:44,vars:3,consts:[[1,"form-container"],[1,"xxl-font","mb-1"],[3,"formGroup"],[1,"container"],["for","product",1,"clr-m"],["name","product","formControlName","product","id","product"],[3,"value"],["for","quantity",1,"clr-m"],["type","number","formControlName","quantity","name","quantity","id","quantity"],[1,"cart-btn","edit","mb-2",3,"click"],[1,"xl-font","mb-1"],[1,"cart"],[1,"cart-item"],[1,"medium-font"],["for","payment",1,"clr-m"],["name","payment","id","payment","formControlName","paymentMethod"],["value","cash"],["value","card"],["value","credit"],["value","giveAway"],["value","other"],[1,"total-bill","xxl-font","m-hz"],[1,"submit-btn","main",3,"click"],[1,"name"],[1,"medium-font","clr-m","mb-1"],[1,"small-font"],[1,"full-price"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 448 512",1,"delete-cart-item"],["d","M135.2 17.7C140.6 6.8 151.7 0 163.8 0L284.2 0c12.1 0 23.2 6.8 28.6 17.7L320 32l96 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 96C14.3 96 0 81.7 0 64S14.3 32 32 32l96 0 7.2-14.3zM32 128l384 0 0 320c0 35.3-28.7 64-64 64L96 512c-35.3 0-64-28.7-64-64l0-320zm96 64c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16z"]],template:function(e,r){e&1&&(n(0,"section",0)(1,"h2",1),o(2,"New Sale"),i(),n(3,"form",2)(4,"div",3)(5,"label",4),o(6,"select product"),i(),n(7,"select",5),p(8,R,2,3,"option",6,L),i()(),n(10,"div",3)(11,"label",7),o(12,"quantity"),i(),S(13,"input",8),i(),n(14,"button",9),g("click",function(){return r.addToCart()}),o(15,"add to cart"),i(),n(16,"div",3)(17,"p",10),o(18,"cart items"),i(),n(19,"div",11),p(20,$,11,4,"div",12,L,!1,W,2,0,"p",13),i()(),n(23,"div",3)(24,"label",14),o(25,"payment method"),i(),n(26,"select",15)(27,"option",16),o(28,"cash"),i(),n(29,"option",17),o(30,"EFT"),i(),n(31,"option",18),o(32,"credit"),i(),n(33,"option",19),o(34,"give away"),i(),n(35,"option",20),o(36,"other"),i()()(),n(37,"div",21)(38,"p"),o(39,"total"),i(),n(40,"p"),o(41),i()(),n(42,"button",22),g("click",function(){return r.sellItem()}),o(43,"add sale"),i()()()),e&2&&(l(3),f("formGroup",r.saleForm),l(5),u(r.stockService.getStock()),l(12),u(r.cartItems()),l(21),h("$\xA0",r.calculateTotalCost()))},dependencies:[j,q,D,G,b,N,z,I,F,T,A,V],styles:[".quick-info[_ngcontent-%COMP%]{max-width:600px;display:flex;justify-content:space-between;align-items:center;padding:10px;margin:1rem auto;padding-inline:5vw}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .cart[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-bottom:1rem}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .cart[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]{display:flex}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .cart[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .full-price[_ngcontent-%COMP%]{margin-left:auto;display:flex;align-items:center;gap:1rem}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .cart[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .full-price[_ngcontent-%COMP%]   .delete-cart-item[_ngcontent-%COMP%]{margin-left:auto;cursor:pointer;width:1.2rem;height:1.2rem;fill:red;transition:all .3s ease-in-out}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .total-bill[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}"]})};export{v as default};
