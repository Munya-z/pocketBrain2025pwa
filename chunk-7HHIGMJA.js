import{a as h,b as y}from"./chunk-Q25FSYLX.js";import{a as O}from"./chunk-CG3X2B2L.js";import{a as I}from"./chunk-Y6PIL4JR.js";import"./chunk-KHYJEK4E.js";import{$ as u,Aa as x,Na as k,Oa as b,Pa as D,Qa as M,Sa as i,Ta as l,Ua as p,Va as E,Wa as S,Xa as f,Y as C,Z as L,_ as d,ab as o,bb as v,cb as m,fa as g,sa as r,wa as _}from"./chunk-RB5HBADI.js";var T=(c,e)=>e.id;function P(c,e){c&1&&(i(0,"p",19),o(1,"credit sale"),l())}function z(c,e){if(c&1&&(i(0,"p",20),o(1),l()),c&2){let n=f().$implicit;r(),m("",n.paymentMethod," sale")}}function A(c,e){if(c&1){let n=E();i(0,"div",18)(1,"div"),k(2,P,2,0,"p",19)(3,z,2,1,"p",20),i(4,"div",21),o(5),l(),i(6,"p",3),o(7),l()(),i(8,"div",22)(9,"div")(10,"p",23),o(11),l(),i(12,"p",24),o(13),l()(),d(),i(14,"svg",25),S("click",function(){let s=C(n).$implicit,a=f();return L(a.deleteSalelog(s))}),p(15,"path",26),l()()()}if(c&2){let n=e.$implicit,t=f();r(2),b(n.paymentMethod=="credit"?2:3),r(3),v(t.getItemNames(n)),r(2),v(n.date),r(4),m("$\xA0",n.amount),r(2),m("",t.salesService.getTotalQuantity(n)," units")}}var w=class c{constructor(e,n){this.salesService=e;this.stockService=n}saleLogs=g(JSON.parse(localStorage.getItem("salesData")||"[]"));inView=g("all recent");changeStyle(e){e.preventDefault(),e.target.classList.remove("edit"),e.target.classList.add("main"),e.target.nextElementSibling?.classList.remove("main"),e.target.nextElementSibling?.classList.add("edit"),e.target.previousElementSibling?.classList.remove("main"),e.target.previousElementSibling?.classList.add("edit")}YDaySales(e){if(this.saleLogs=g(JSON.parse(localStorage.getItem("salesData"))),e==="all"){this.inView.set("all recent");return}e==="YDay"&&(this.inView.set("yesterday"),this.saleLogs.update(n=>n.filter(t=>{let s=new Date(t.date),a=new Date;return s.getDate()===a.getDate()-1&&s.getMonth()===a.getMonth()&&s.getFullYear()===a.getFullYear()}))),e==="today"&&(this.inView.set("todays"),this.saleLogs=g(JSON.parse(localStorage.getItem("salesData"))),this.saleLogs.update(n=>n.filter(t=>{let s=new Date(t.date),a=new Date;return s.getDate()===a.getDate()&&s.getMonth()===a.getMonth()&&s.getFullYear()===a.getFullYear()})))}getItemNames(e){return!e||!e.itemsSold||!Array.isArray(e.itemsSold)?[]:e.itemsSold.map(n=>n.item)}calculateCurrentWeekSalesTotal(e){let n=h(),t=y(n);return e.filter(s=>{let a=new Date(s.date);return a>=n&&a<=t}).reduce((s,a)=>s+(Number(a.amount)||0),0)}countCurrentWeekSales(e){let n=h(),t=y(n);return console.log(e,"is it an array ",Array.isArray(e)),Array.isArray(e)?e.filter(s=>{let a=new Date(s.date);return a>=n&&a<=t}).length:0}deleteSalelog(e){for(let n of e.itemsSold){let t=this.stockService.getStock().filter(s=>s.id===n.id);t[0]&&(t[0].quantity+=n.quantity,this.stockService.getStock.update(s=>s.map(a=>a.id===t[0].id?t[0]:a)),localStorage.setItem("stock",JSON.stringify(this.stockService.getStock())))}confirm(`Delete ${e.id}`)&&(this.salesService.deleteSalesEntry(e),window.location.reload())}static \u0275fac=function(n){return new(n||c)(_(O),_(I))};static \u0275cmp=x({type:c,selectors:[["app-sales-logs"]],decls:48,vars:5,consts:[[1,"sales-header"],[1,"clr-white"],[1,"xxl-font","mb-1"],[1,"small-font"],[1,"cards"],[1,"card"],[1,"clr-m-light","small-font","mb-1"],[1,"clr-white","xxl-font","mb-1"],[1,"clr-m-light","small-font"],[1,"action-buttons","mb-2"],[1,"edit",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 448 512"],["d","M128 0c17.7 0 32 14.3 32 32l0 32 128 0 0-32c0-17.7 14.3-32 32-32s32 14.3 32 32l0 32 48 0c26.5 0 48 21.5 48 48l0 48L0 160l0-48C0 85.5 21.5 64 48 64l48 0 0-32c0-17.7 14.3-32 32-32zM0 192l448 0 0 272c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 192zM312 376c13.3 0 24-10.7 24-24s-10.7-24-24-24l-176 0c-13.3 0-24 10.7-24 24s10.7 24 24 24l176 0z"],["d","M128 0c17.7 0 32 14.3 32 32l0 32 128 0 0-32c0-17.7 14.3-32 32-32s32 14.3 32 32l0 32 48 0c26.5 0 48 21.5 48 48l0 48L0 160l0-48C0 85.5 21.5 64 48 64l48 0 0-32c0-17.7 14.3-32 32-32zM0 192l448 0 0 272c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 192zm80 64c-8.8 0-16 7.2-16 16l0 96c0 8.8 7.2 16 16 16l96 0c8.8 0 16-7.2 16-16l0-96c0-8.8-7.2-16-16-16l-96 0z"],["d","M96 32l0 32L48 64C21.5 64 0 85.5 0 112l0 48 448 0 0-48c0-26.5-21.5-48-48-48l-48 0 0-32c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 32L160 64l0-32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192L0 192 0 464c0 26.5 21.5 48 48 48l352 0c26.5 0 48-21.5 48-48l0-272z"],[1,"logs-list"],[1,"xl-font","mt-2"],[1,"logs-container"],["routerLink","view-debtor-details",1,"log"],[1,"mb-1","clr-dan","medium-font"],[1,"mb-1","medium-font"],[1,"mb-1","bg-white","small-font"],[1,"right"],[1,"mb-1","normal-font"],[1,"active-debts","small-font"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 448 512",3,"click"],["d","M135.2 17.7C140.6 6.8 151.7 0 163.8 0L284.2 0c12.1 0 23.2 6.8 28.6 17.7L320 32l96 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 96C14.3 96 0 81.7 0 64S14.3 32 32 32l96 0 7.2-14.3zM32 128l384 0 0 320c0 35.3-28.7 64-64 64L96 512c-35.3 0-64-28.7-64-64l0-320zm96 64c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16z"]],template:function(n,t){n&1&&(i(0,"section")(1,"section",0)(2,"header",1)(3,"h2",2),o(4,"Sales logs"),l(),i(5,"p",3),o(6,"what you have sold so far"),l()(),i(7,"div",4)(8,"div",5)(9,"div",6),o(10," total Sales "),l(),i(11,"div",7)(12,"p"),o(13),l()(),i(14,"div",8)(15,"p"),o(16),l()()(),i(17,"div",5)(18,"div",6),o(19," total revenue "),l(),i(20,"div",7)(21,"p"),o(22),l()(),i(23,"div",8)(24,"p"),o(25),l()()()()(),i(26,"div",9)(27,"button",10),S("click",function(a){return t.YDaySales("YDay"),t.changeStyle(a)}),d(),i(28,"svg",11),p(29,"path",12),l(),u(),i(30,"p"),o(31,"YDay"),l()(),i(32,"button",10),S("click",function(a){return t.YDaySales("today"),t.changeStyle(a)}),d(),i(33,"svg",11),p(34,"path",13),l(),u(),i(35,"p"),o(36,"today"),l()(),i(37,"button",10),S("click",function(a){return t.YDaySales("all"),t.changeStyle(a)}),d(),i(38,"svg",11),p(39,"path",14),l(),u(),i(40,"p"),o(41,"all"),l()()()(),i(42,"section",15)(43,"h2",16),o(44),l(),i(45,"div",17),D(46,A,16,5,"div",18,T),l()()),n&2&&(r(13),v(t.saleLogs().length),r(3),m("",t.countCurrentWeekSales(t.saleLogs())," more this week"),r(6),m("$\xA0",t.salesService.calculateTotalSalesAmount(t.saleLogs())),r(3),m("+",t.calculateCurrentWeekSalesTotal(t.saleLogs())," \xA0sold this week"),r(19),m("",t.inView()," sales"),r(2),M(t.saleLogs()))},styles:["header[_ngcontent-%COMP%]{padding:1rem 5vw 0;background-color:#0b1612}.right[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:1rem}.right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;fill:red}.cards[_ngcontent-%COMP%]{display:flex;gap:2rem;width:100%;margin:0 auto 1rem;background-color:#0b1612;padding:1rem 5vw}.cards[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{padding:1rem 0;width:50%}section[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:30%}.logs-list[_ngcontent-%COMP%]{padding:0 5vw}.logs-list[_ngcontent-%COMP%]   .logs-container[_ngcontent-%COMP%]   .log[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 0}"]})};export{w as default};
