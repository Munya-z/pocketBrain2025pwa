import{a as w,b as M}from"./chunk-Q25FSYLX.js";import{a as F}from"./chunk-KMUJ6N6O.js";import{a as P,b as T,c as I,d as N,e as V,f as A,g as z,i as Y,j as W,k as G,p as j}from"./chunk-GOMNIGAX.js";import{a as q}from"./chunk-MCV5SLSJ.js";import"./chunk-6AXJB3HD.js";import{$ as f,Aa as x,Na as b,Oa as k,Pa as E,Qa as D,Ra as O,Sa as i,Ta as l,Ua as m,Va as C,Wa as d,Xa as u,Y as _,Z as h,_ as S,ab as r,bb as v,cb as g,fa as p,sa as s,wa as y}from"./chunk-RB5HBADI.js";var H=(c,t)=>t.id;function J(c,t){if(c&1){let n=C();i(0,"p",38),d("click",function(){_(n);let o=u().$implicit,a=u();return a.selectSale(o.id),h(a.openModal())}),r(1,"credit sale"),l()}}function B(c,t){if(c&1&&(i(0,"p",31),r(1),l()),c&2){let n=u().$implicit;s(),g("",n.paymentMethod," sale")}}function R(c,t){if(c&1){let n=C();i(0,"div",18)(1,"div"),b(2,J,2,0,"p",30)(3,B,2,1,"p",31),i(4,"div",32),r(5),l(),i(6,"p",3),r(7),l()(),i(8,"div",33)(9,"div")(10,"p",34),r(11),l(),i(12,"p",35),r(13),l()(),S(),i(14,"svg",36),d("click",function(){let o=_(n).$implicit,a=u();return h(a.deleteSalelog(o))}),m(15,"path",37),l()()()}if(c&2){let n=t.$implicit,e=u();s(2),k(n.paymentMethod=="credit"?2:3),s(3),v(e.getItemNames(n)),s(2),v(n.date),s(4),g("$\xA0",n.amount),s(2),g("",e.salesService.getTotalQuantity(n)," units")}}var L=class c{constructor(t,n){this.salesService=t;this.stockService=n}saleLogs=p(JSON.parse(localStorage.getItem("salesData")||"[]"));selectedSalelog=p(this.saleLogs()[0]);inView=p("all recent");changeStyle(t){t.preventDefault(),t.target.classList.remove("edit"),t.target.classList.add("main"),t.target.nextElementSibling?.classList.remove("main"),t.target.nextElementSibling?.classList.add("edit"),t.target.previousElementSibling?.classList.remove("main"),t.target.previousElementSibling?.classList.add("edit")}changePaymentForm=new V({paymentMethod:new A("",T.required)});YDaySales(t){if(this.saleLogs=p(JSON.parse(localStorage.getItem("salesData"))),t==="all"){this.inView.set("all recent");return}t==="YDay"&&(this.inView.set("yesterday"),this.saleLogs.update(n=>n.filter(e=>{let o=new Date(e.date),a=new Date;return o.getDate()===a.getDate()-1&&o.getMonth()===a.getMonth()&&o.getFullYear()===a.getFullYear()}))),t==="today"&&(this.inView.set("todays"),this.saleLogs=p(JSON.parse(localStorage.getItem("salesData"))),this.saleLogs.update(n=>n.filter(e=>{let o=new Date(e.date),a=new Date;return o.getDate()===a.getDate()&&o.getMonth()===a.getMonth()&&o.getFullYear()===a.getFullYear()})))}getItemNames(t){return!t||!t.itemsSold||!Array.isArray(t.itemsSold)?[]:t.itemsSold.map(n=>n.item)}calculateCurrentWeekSalesTotal(t){let n=w(),e=M(n);return t.filter(o=>{let a=new Date(o.date);return a>=n&&a<=e}).reduce((o,a)=>o+(Number(a.amount)||0),0)}countCurrentWeekSales(t){let n=w(),e=M(n);return Array.isArray(t)?t.filter(o=>{let a=new Date(o.date);return a>=n&&a<=e}).length:0}deleteSalelog(t){for(let n of t.itemsSold){let e=this.stockService.getStock().filter(o=>o.id===n.id);e[0]&&(e[0].quantity+=n.quantity,this.stockService.getStock.update(o=>o.map(a=>a.id===e[0].id?e[0]:a)),localStorage.setItem("stock",JSON.stringify(this.stockService.getStock())))}confirm(`Delete ${t.id}`)&&(this.salesService.deleteSalesEntry(t),window.location.reload())}selectSale(t){let n=this.saleLogs().filter(e=>e.id===t);this.selectedSalelog.set(n)}openModal(){document.querySelector(".edit-credit-sale")?.showModal()}closeModal(t){t.preventDefault(),document.querySelector(".edit-credit-sale")?.close()}editSalelog(t){t.preventDefault(),this.selectedSalelog()&&(this.selectedSalelog()[0].paymentMethod=this.changePaymentForm.value.paymentMethod,this.saleLogs.update(n=>n.map(e=>e.id===this.selectedSalelog()[0].id?this.selectedSalelog()[0]:e)),localStorage.setItem("salesData",JSON.stringify(this.saleLogs())))}static \u0275fac=function(n){return new(n||c)(y(F),y(q))};static \u0275cmp=x({type:c,selectors:[["app-sales-logs"]],decls:73,vars:6,consts:[[1,"sales-header"],[1,"clr-white"],[1,"xxl-font","mb-1"],[1,"small-font"],[1,"cards"],[1,"card"],[1,"clr-m-light","small-font","mb-1"],[1,"clr-white","xxl-font","mb-1"],[1,"clr-m-light","small-font"],[1,"action-buttons","mb-2"],[1,"edit",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 448 512"],["d","M128 0c17.7 0 32 14.3 32 32l0 32 128 0 0-32c0-17.7 14.3-32 32-32s32 14.3 32 32l0 32 48 0c26.5 0 48 21.5 48 48l0 48L0 160l0-48C0 85.5 21.5 64 48 64l48 0 0-32c0-17.7 14.3-32 32-32zM0 192l448 0 0 272c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 192zM312 376c13.3 0 24-10.7 24-24s-10.7-24-24-24l-176 0c-13.3 0-24 10.7-24 24s10.7 24 24 24l176 0z"],["d","M128 0c17.7 0 32 14.3 32 32l0 32 128 0 0-32c0-17.7 14.3-32 32-32s32 14.3 32 32l0 32 48 0c26.5 0 48 21.5 48 48l0 48L0 160l0-48C0 85.5 21.5 64 48 64l48 0 0-32c0-17.7 14.3-32 32-32zM0 192l448 0 0 272c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 192zm80 64c-8.8 0-16 7.2-16 16l0 96c0 8.8 7.2 16 16 16l96 0c8.8 0 16-7.2 16-16l0-96c0-8.8-7.2-16-16-16l-96 0z"],["d","M96 32l0 32L48 64C21.5 64 0 85.5 0 112l0 48 448 0 0-48c0-26.5-21.5-48-48-48l-48 0 0-32c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 32L160 64l0-32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192L0 192 0 464c0 26.5 21.5 48 48 48l352 0c26.5 0 48-21.5 48-48l0-272z"],[1,"logs-list"],[1,"xl-font","mt-2"],[1,"logs-container"],["routerLink","view-debtor-details",1,"log"],[1,"edit-credit-sale"],[1,"xl-font"],[3,"formGroup"],[1,"option"],["type","radio","formControlName","paymentMethod","value","cash",1,"radio-button"],["type","radio","formControlName","paymentMethod","value","EFT",1,"radio-button"],["type","radio","formControlName","paymentMethod","value","other",1,"radio-button"],["type","radio","formControlName","paymentMethod","value","give away",1,"radio-button"],[1,"btn"],[1,"main",3,"click"],[1,"delete",3,"click"],[1,"mb-1","clr-dan","medium-font"],[1,"mb-1","medium-font"],[1,"mb-1","bg-white","small-font"],[1,"right"],[1,"mb-1","normal-font"],[1,"active-debts","small-font"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 448 512",3,"click"],["d","M135.2 17.7C140.6 6.8 151.7 0 163.8 0L284.2 0c12.1 0 23.2 6.8 28.6 17.7L320 32l96 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 96C14.3 96 0 81.7 0 64S14.3 32 32 32l96 0 7.2-14.3zM32 128l384 0 0 320c0 35.3-28.7 64-64 64L96 512c-35.3 0-64-28.7-64-64l0-320zm96 64c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16z"],[1,"mb-1","clr-dan","medium-font",3,"click"]],template:function(n,e){n&1&&(i(0,"section")(1,"section",0)(2,"header",1)(3,"h2",2),r(4,"Sales logs"),l(),i(5,"p",3),r(6,"what you have sold so far"),l()(),i(7,"div",4)(8,"div",5)(9,"div",6),r(10," total Sales "),l(),i(11,"div",7)(12,"p"),r(13),l()(),i(14,"div",8)(15,"p"),r(16),l()()(),i(17,"div",5)(18,"div",6),r(19," total revenue "),l(),i(20,"div",7)(21,"p"),r(22),l()(),i(23,"div",8)(24,"p"),r(25),l()()()()(),i(26,"div",9)(27,"button",10),d("click",function(a){return e.YDaySales("YDay"),e.changeStyle(a)}),S(),i(28,"svg",11),m(29,"path",12),l(),f(),i(30,"p"),r(31,"YDay"),l()(),i(32,"button",10),d("click",function(a){return e.YDaySales("today"),e.changeStyle(a)}),S(),i(33,"svg",11),m(34,"path",13),l(),f(),i(35,"p"),r(36,"today"),l()(),i(37,"button",10),d("click",function(a){return e.YDaySales("all"),e.changeStyle(a)}),S(),i(38,"svg",11),m(39,"path",14),l(),f(),i(40,"p"),r(41,"all"),l()()()(),i(42,"section",15)(43,"h2",16),r(44),l(),i(45,"div",17),E(46,R,16,5,"div",18,H),l()(),i(48,"dialog",19)(49,"p",20),r(50,"selected new payment menthod"),l(),i(51,"form",21)(52,"div",22)(53,"p"),r(54,"cash"),l(),m(55,"input",23),l(),i(56,"div",22)(57,"p"),r(58,"EFT"),l(),m(59,"input",24),l(),i(60,"div",22)(61,"p"),r(62,"other"),l(),m(63,"input",25),l(),i(64,"div",22)(65,"p"),r(66,"give Away"),l(),m(67,"input",26),l(),i(68,"div",27)(69,"button",28),d("click",function(a){return e.editSalelog(a),e.closeModal(a)}),r(70,"update"),l(),i(71,"button",29),d("click",function(a){return e.closeModal(a)}),r(72,"cancel"),l()()()()),n&2&&(s(13),v(e.saleLogs().length),s(3),g("",e.countCurrentWeekSales(e.saleLogs())," more this week"),s(6),g("$\xA0",e.salesService.calculateTotalSalesAmount(e.saleLogs())),s(3),g("+",e.calculateCurrentWeekSalesTotal(e.saleLogs())," \xA0sold this week"),s(19),g("",e.inView()," sales"),s(2),D(e.saleLogs()),s(5),O("formGroup",e.changePaymentForm))},dependencies:[j,z,P,Y,I,N,W,G],styles:["header[_ngcontent-%COMP%]{padding:1rem 5vw 0;background-color:#0b1612}.right[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:1rem}.right[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;fill:red}.cards[_ngcontent-%COMP%]{display:flex;gap:2rem;width:100%;margin:0 auto 1rem;background-color:#0b1612;padding:1rem 5vw}.cards[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{padding:1rem 0;width:50%}section[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:30%}.logs-list[_ngcontent-%COMP%]{padding:0 5vw}.logs-list[_ngcontent-%COMP%]   .logs-container[_ngcontent-%COMP%]   .log[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 0}",".option[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:50%;padding:1rem 0;margin:1rem auto}:is(.option[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%])   button[_ngcontent-%COMP%]{width:45%}"]})};export{L as default};
